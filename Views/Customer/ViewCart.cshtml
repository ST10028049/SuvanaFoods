@model IEnumerable<SuvanaFoods.Models.Cart>
@{
    ViewBag.Title = "Shopping Cart";
}

<div class="container mt-4" style="margin-top: 70px;">
    <h2 class="text-center">Your Cart</h2>

    @if (Model.Any())
    {
        <div class="row">
            <div class="col-md-12">
                <table class="table table-hover">
                    <thead>
                        <tr>
                            <th>Image</th>
                            <th>Item</th>
                            <th>Price</th>
                            <th>Quantity</th>
                            <th>Total</th>
                            <th>Action</th>
                        </tr>
                    </thead>
                    <tbody>
                        @foreach (var cartItem in Model)
                        {
                            <tr>
                                <td>
                                    <img src="@cartItem.FoodItem.ImageUrl" alt="@cartItem.FoodItem.Name"
                                         class="img-fluid" style="width: 100px; height: 100px; object-fit: cover;" />
                                </td>
                                <td>@cartItem.FoodItem.Name</td>
                                <td>@(cartItem.FoodItem.Price?.ToString("C") ?? "$0.00")</td>
                                <td>
                                    <input type="number" value="@cartItem.Quantity" min="1" max="@cartItem.FoodItem.Quantity"
                                           class="form-control quantity-input"
                                           data-item-id="@cartItem.FoodItem.FoodItemId" />
                                    <span class="text-danger stock-warning" data-item-id="@cartItem.FoodItem.FoodItemId"
                                          style="display:none;">Quantity exceeds available stock!</span>
                                </td>
                                <td class="item-total" data-item-id="@cartItem.FoodItem.FoodItemId">
                                    @(cartItem.FoodItem.Price.GetValueOrDefault() * cartItem.Quantity.GetValueOrDefault(1)).ToString("C")
                                </td>
                                <td>
                                    <button class="btn btn-danger remove-item" data-item-id="@cartItem.FoodItem.FoodItemId">
                                        Remove
                                    </button>
                                </td>
                            </tr>
                        }
                    </tbody>
                </table>

                <div class="total-amount">
                    <h4>Total: <span id="total-amount">@Model.Sum(item => item.FoodItem.Price.GetValueOrDefault() * item.Quantity.GetValueOrDefault(1)).ToString("C")</span></h4>
                </div>

                <button class="btn btn-primary float-right">Proceed to Checkout</button>
            </div>
        </div>
    }
    else
    {
        <p class="text-center">Your cart is empty!</p>
    }
</div>

